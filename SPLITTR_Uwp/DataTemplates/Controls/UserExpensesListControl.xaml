<UserControl
    x:Class="SPLITTR_Uwp.DataTemplates.Controls.UserExpensesListControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SPLITTR_Uwp.DataTemplates"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:template="using:SPLITTR_Uwp.DataTemplates"
    xmlns:vm="using:SPLITTR_Uwp.ViewModel.Models"
    xmlns:header="using:SPLITTR_Uwp.ViewModel.Models.ExpenseListObject"
    mc:Ignorable="d"
    d:DesignHeight="300" Background="Transparent"
    
    d:DesignWidth="400">

    <Grid>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="PaneButtonStateGroup" >
                <VisualState x:Name="ClosePaneState" >
                    <VisualState.Setters>
                        <Setter Target="NavigationPaneControlButton.Content">
                            <Setter.Value>
                                <Path Fill="{ThemeResource TextFillColorPrimaryBrush}"  StrokeThickness="5" Data="M12,2.99872 C13.0543909,2.99872 13.9181678,3.81459733 13.9945144,4.84945759 L14,4.99872 L14,11.0011 C14,12.0554909 13.18415,12.9192678 12.1492661,12.9956144 L12,13.0011 L4,13.0011 C2.94563773,13.0011 2.08183483,12.18525 2.00548573,11.1503661 L2,11.0011 L2,4.99872 C2,3.94435773 2.81587733,3.08055483 3.85073759,3.00420573 L4,2.99872 L12,2.99872 Z M6.00153,3.99872 L4,3.99872 C3.48716857,3.99872 3.06449347,4.38475566 3.0067278,4.8820979 L3,4.99872 L3,11.0011 C3,11.51395 3.38604429,11.9366092 3.88337975,11.9943725 L4,12.0011 L6.00153,12.0011 L6.00153,3.99872 Z M12,3.99872 L7.00152,3.99872 L7.00152,12.0011 L12,12.0011 C12.5523,12.0011 13,11.5534 13,11.0011 L13,4.99872 C13,4.44643 12.5523,3.99872 12,3.99872 Z M10.3536,6.14639 C10.5488,6.34165 10.5488,6.65823 10.3536,6.85349 L9.70711,7.4999375 L11.4983,7.4999375 C11.7744,7.4999375 11.9983,7.7238 11.9983,7.9999375 C11.9983,8.27608 11.7744,8.4999375 11.4983,8.4999375 L9.70711,8.4999375 L10.3536,9.14639 C10.5488,9.34165 10.5488,9.65823 10.3536,9.85349 C10.1583,10.0488 9.84171,10.0488 9.64645,9.85349 L8.14645,8.35349 C7.95118,8.15823 7.95118,7.84165 8.14645,7.64639 L9.64645,6.14639 C9.84171,5.95112 10.1583,5.95112 10.3536,6.14639 Z"
                                      Height="16" Stretch="Fill" UseLayoutRounding="False" Width="16"/>
                            </Setter.Value>
                        </Setter>
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="OpenPaneState">
                    <VisualState.Setters>
                        <Setter Target="NavigationPaneControlButton.Content">
                            <Setter.Value>
                                <Path Fill="{ThemeResource TextFillColorPrimaryBrush}" Data="M12,2.99887 C13.0543909,2.99887 13.9181678,3.81474733 13.9945144,4.84960759 L14,4.99887 L14,11.0013 C14,12.0555955 13.18415,12.9194591 12.1492661,12.9958139 L12,13.0013 L4,13.0013 C2.94563773,13.0013 2.08183483,12.1853589 2.00548573,11.1505537 L2,11.0013 L2,4.99887 C2,3.94450773 2.81587733,3.08070483 3.85073759,3.00435573 L4,2.99887 L12,2.99887 Z M12,3.99887 L9.99847,3.99887 L9.99847,12.0013 L12,12.0013 C12.51285,12.0013 12.9355092,11.6151867 12.9932725,11.1179055 L13,11.0013 L13,4.99887 C13,4.48602929 12.613973,4.06336214 12.1166239,4.00559766 L12,3.99887 Z M8.99848,3.99887 L4,3.99887 C3.48716857,3.99887 3.06449347,4.38490566 3.0067278,4.8822479 L3,4.99887 L3,11.0013 C3,11.5140571 3.38603566,11.9367959 3.8833779,11.9945711 L4,12.0013 L8.99848,12.0013 L8.99848,3.99887 Z M6.28430284,6.08859222 L6.35355,6.14645 L7.85355,7.64645 C8.02712333,7.82001444 8.04640926,8.08943667 7.91140778,8.28430284 L7.85355,8.35355 L6.35355,9.85355 C6.15829,10.0488 5.84171,10.0488 5.64645,9.85355 C5.47287667,9.67998556 5.45359074,9.41056333 5.58859222,9.21569716 L5.64645,9.14645 L6.29289,8.4999975 L4.50185,8.4999975 C4.2257,8.4999975 4.00185,8.27614 4.00185,7.9999975 C4.00185,7.75454194 4.17871914,7.55039009 4.41197236,7.50805333 L4.50185,7.4999975 L6.29289,7.4999975 L5.64645,6.85355 C5.45118,6.65829 5.45118,6.34171 5.64645,6.14645 C5.82001444,5.97287667 6.08943667,5.95359074 6.28430284,6.08859222 Z" 
                                      Height="16" Stretch="Fill" UseLayoutRounding="False" Width="16"/>
                            </Setter.Value>
                        </Setter>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Grid.Resources>
            <CollectionViewSource  x:Name="CollectionViewSource" x:Key="GroupedSource" IsSourceGrouped="True"/>
            <Style x:Key="HideExpensesButtonStyle" x:FieldModifier="public" x:Name="HideExpenseButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="BorderBrush" Value="Transparent" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="Foreground" Value="{ThemeResource SystemAccentColorDark1}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <FontIcon FontFamily="Segoe MDL2 Assets" VerticalAlignment="{TemplateBinding VerticalAlignment}"  Glyph="&#xE761;" Margin="2 2 4 0" FontSize="20"/>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="ShowExpensesButtonStyle" x:Name="ShowExpenseButtonStyle" x:FieldModifier="public" TargetType="Button">
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="BorderBrush" Value="Transparent" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="Foreground" Value="{ThemeResource SystemAccentColorDark1}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <FontIcon FontFamily="Segoe MDL2 Assets" VerticalAlignment="{TemplateBinding VerticalAlignment}"  Glyph="&#xE7B3;" Margin="2 2 4 0" FontSize="20"/>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style TargetType="ListViewItem" >
                <Setter Property="MinHeight" Value="0"></Setter>
                <Setter Property="HorizontalAlignment" Value="Stretch"/>
                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                <Setter Property="CornerRadius" Value="10"></Setter>
                <Setter Property="Margin" Value="0 2 0 0"></Setter>
            </Style>
        </Grid.Resources>
        <Grid Grid.Column="0" Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" CornerRadius="5" Padding="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <RelativePanel Grid.Row="0">

                <StackPanel Orientation="Horizontal">

                    <Button  x:Name="NavigationPaneControlButton"
                             Click="NavigationPaneName_OnClick" 
                             CornerRadius="4"
                             Margin="5" ToolTipService.ToolTip="Pane Flip"
                             BorderBrush="Transparent" Background="Transparent" Style="{ThemeResource NoPointerAnimation}">

                        <Button.Content>
                            <Path Fill="{ThemeResource TextFillColorPrimaryBrush}"  StrokeThickness="5" Data="M12,2.99872 C13.0543909,2.99872 13.9181678,3.81459733 13.9945144,4.84945759 L14,4.99872 L14,11.0011 C14,12.0554909 13.18415,12.9192678 12.1492661,12.9956144 L12,13.0011 L4,13.0011 C2.94563773,13.0011 2.08183483,12.18525 2.00548573,11.1503661 L2,11.0011 L2,4.99872 C2,3.94435773 2.81587733,3.08055483 3.85073759,3.00420573 L4,2.99872 L12,2.99872 Z M6.00153,3.99872 L4,3.99872 C3.48716857,3.99872 3.06449347,4.38475566 3.0067278,4.8820979 L3,4.99872 L3,11.0011 C3,11.51395 3.38604429,11.9366092 3.88337975,11.9943725 L4,12.0011 L6.00153,12.0011 L6.00153,3.99872 Z M12,3.99872 L7.00152,3.99872 L7.00152,12.0011 L12,12.0011 C12.5523,12.0011 13,11.5534 13,11.0011 L13,4.99872 C13,4.44643 12.5523,3.99872 12,3.99872 Z M10.3536,6.14639 C10.5488,6.34165 10.5488,6.65823 10.3536,6.85349 L9.70711,7.4999375 L11.4983,7.4999375 C11.7744,7.4999375 11.9983,7.7238 11.9983,7.9999375 C11.9983,8.27608 11.7744,8.4999375 11.4983,8.4999375 L9.70711,8.4999375 L10.3536,9.14639 C10.5488,9.34165 10.5488,9.65823 10.3536,9.85349 C10.1583,10.0488 9.84171,10.0488 9.64645,9.85349 L8.14645,8.35349 C7.95118,8.15823 7.95118,7.84165 8.14645,7.64639 L9.64645,6.14639 C9.84171,5.95112 10.1583,5.95112 10.3536,6.14639 Z"
                                  Height="16" Stretch="Fill" UseLayoutRounding="False" Width="16"/>
                        </Button.Content>
                    </Button>

                    <TextBlock Text="{x:Bind ViewModel.TitleText,Mode=OneWay}" VerticalAlignment="Center" FontWeight="SemiBold" Margin="0 2 0 0" FontSize="18"></TextBlock>
                </StackPanel>
                <DropDownButton Content="" FontFamily="Segoe MDL2 Assets"
                                RelativePanel.AlignRightWithPanel="True"
                                Background="Transparent" Margin="4"
                                BorderBrush="Transparent">
                    <DropDownButton.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem Text="Date" x:Name="DateMenuItem" Click="SortingFlyoutButton_OnClick">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon FontFamily="Segoe MDL2 Assets" Glyph=""/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Text="Status" x:Name="StatusMenuItem" Click="SortingFlyoutButton_OnClick">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon FontFamily="Segoe MDL2 Assets" Glyph=""/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                        </MenuFlyout>
                    </DropDownButton.Flyout>
                </DropDownButton>
            </RelativePanel>
            <!-- Grouped Expense List View   -->
            <ListView Grid.Row="1" x:Name="ExpensesLIstView" 
                      ItemsSource="{x:Bind CollectionViewSource.View , Mode=OneWay}"
                      SelectionChanged="ExpensesLIstView_OnSelectionChanged"
                      SelectedIndex="-1"
                      SelectedItem="{x:Bind ViewModel.SelectedExpenseObj,Mode=TwoWay}">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="vm:ExpenseViewModel">
                        <template:ExpenseDataTemplateV2 HorizontalAlignment="Stretch"
                                                        CornerRadius="5"
                                                        Visibility="{x:Bind Visibility,Mode=OneWay}"></template:ExpenseDataTemplateV2>
                        <!--<template:ExpenseDataTemplate HorizontalAlignment="Stretch" DateOfExpenseTextBlockVisibility="Visible"
                                                      ExpenseStatusVisibility="Collapsed" CornerRadius="5"/>-->
                    </DataTemplate>
                </ListView.ItemTemplate>
                <ListView.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.HeaderTemplate>
                            <DataTemplate x:DataType="header:ExpenseGroupingList" >
                                <Grid HorizontalAlignment="Stretch" Width="{Binding ElementName=ExpensesLIstView,Path=ActualWidth,Mode=OneWay}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Orientation="Horizontal"  Grid.Column="0" Margin="10,0">
                                        <StackPanel.Resources>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="{ThemeResource AccentTextColorBrush}"></Setter>
                                            </Style>
                                        </StackPanel.Resources>
                                        <Button Click="ExpenseShowButton_OnClick" Style="{ThemeResource ShowExpensesButtonStyle}">
                                        </Button>
                                        <TextBlock Text="{x:Bind GroupHeader.GroupName, Mode=OneWay}"   
                                                   FontWeight="Bold" />
                                        <TextBlock Text="(" Margin="5 0 0 0"/>
                                        <TextBlock Text="{x:Bind GroupHeader.NoOfExpenses,Mode=OneWay}" Margin="0"></TextBlock>
                                        <TextBlock Text=")"/>
                                    </StackPanel>
                                    <!--<MenuFlyoutSeparator Grid.Row="1" HorizontalAlignment="Stretch" Margin="10 0 30 0"></MenuFlyoutSeparator>-->

                                </Grid>

                                <!---->

                            </DataTemplate>
                        </GroupStyle.HeaderTemplate>
                        <GroupStyle.HeaderContainerStyle>
                            <Style TargetType="ListViewHeaderItem">
                                <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}" />
                                <Setter Property="FontSize" Value="{ThemeResource ListViewHeaderItemThemeFontSize}" />
                                <Setter Property="Margin" Value="0" />
                                <Setter Property="Padding" Value="12,8,12,0" />
                                <Setter Property="HorizontalContentAlignment" Value="Left" />
                                <Setter Property="VerticalContentAlignment" Value="Center" />
                                <Setter Property="MinHeight" Value="{ThemeResource ListViewHeaderItemMinHeight}" />
                                <Setter Property="UseSystemFocusVisuals" Value="True" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListViewHeaderItem">
                                            <ContentPresenter x:Name="ContentPresenter"
                                                    Background="{TemplateBinding Background}"
                                                    Content="{TemplateBinding Content}"
                                                    ContentTemplate="{TemplateBinding ContentTemplate}"
                                                    ContentTransitions="{TemplateBinding ContentTransitions}"
                                                    HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                    VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </GroupStyle.HeaderContainerStyle>
                    </GroupStyle>
                </ListView.GroupStyle>
            </ListView>
            <ListView Visibility="Collapsed" Grid.Row="1" x:Name="DateSortedList"
                      ItemsSource="{x:Bind ViewModel.DateSortedExpenseList,Mode=OneWay}"
                      SelectionChanged="ExpensesLIstView_OnSelectionChanged"
                      SelectedIndex="-1"
                      SelectedItem="{x:Bind ViewModel.SelectedExpenseObj,Mode=TwoWay}">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="vm:ExpenseViewModel">
                        <template:ExpenseDataTemplateV2 HorizontalAlignment="Stretch"
                                                        CornerRadius="5"
                                                        Visibility="Visible"></template:ExpenseDataTemplateV2>
                        <!--<template:ExpenseDataTemplate HorizontalAlignment="Stretch" DateOfExpenseTextBlockVisibility="Visible"
                                                      ExpenseStatusVisibility="Collapsed" CornerRadius="5"/>-->
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

        </Grid>
    </Grid>
</UserControl>
